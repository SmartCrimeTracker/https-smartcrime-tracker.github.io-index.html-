<!doctype html>
<html lang="bn">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Smart Crime Tracker ‚Äî Presentation Demo</title>
<meta name="description" content="Smart Crime Tracker ‚Äî UI demo (safe, mock data)"/>
<style>
:root{
  --bg1:#041218; --bg2:#00372e; --card: rgba(6,18,16,0.88);
  --glass: rgba(255,255,255,0.03); --accent:#00e486; --muted:#9fdad0;
  --text:#e9fff6;
  --shadow:0 16px 50px rgba(0,0,0,0.6);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;color:var(--text);background:linear-gradient(180deg,var(--bg1),var(--bg2));-webkit-font-smoothing:antialiased}
.container{max-width:1200px;margin:18px auto;padding:12px}
.header{display:flex;gap:14px;align-items:center;padding:12px}
.logoBox{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#16c7ff);display:grid;place-items:center;font-weight:800;color:#012}
.title h1{margin:0;font-size:20px}
.title p{margin:4px 0 0;color:var(--muted);font-size:13px}

/* layout */
.topbar{display:flex;align-items:center;gap:8px;padding:8px 0}
.nav{display:flex;gap:8px}
.nav button{background:transparent;border:1px solid var(--glass);color:var(--muted);padding:8px 12px;border-radius:999px;cursor:pointer;font-weight:600}
.nav button.active{border-color:rgba(0,230,134,0.45);color:var(--text);background:linear-gradient(90deg, rgba(0,230,134,0.04), rgba(0,230,134,0.01))}
.userInfo{margin-left:auto;color:var(--muted);font-size:13px}

/* grid */
.layout{display:grid;grid-template-columns:1fr 380px;gap:18px;padding-top:12px;min-height:70vh}
@media (max-width:980px){.layout{grid-template-columns:1fr}}
.panel{background:var(--card);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:var(--shadow)}
.kpis{display:flex;gap:12px;margin-bottom:12px;flex-wrap:wrap}
.kpi{flex:1;min-width:140px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:12px;border-radius:10px}
.kpi .num{font-size:22px;font-weight:800;color:var(--accent)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}
@media (max-width:800px){.grid2{grid-template-columns:1fr}}

/* forms */
input[type=text], textarea, select{background:var(--glass);border:1px solid rgba(255,255,255,0.03);color:inherit;padding:10px;border-radius:8px;outline:none;width:100%}
button.btn{background:linear-gradient(180deg,var(--accent),#00b36a);border:none;padding:10px 14px;border-radius:10px;color:#012;cursor:pointer;font-weight:700}
button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:8px 10px;border-radius:8px}
.tiny{font-size:13px;color:var(--muted)}
.note{font-size:13px;color:var(--muted);margin-top:8px}
.table{width:100%;border-collapse:collapse}
th,td{padding:8px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.02);font-size:13px}
tr:hover td{background:rgba(0,0,0,0.06)}
.mapFrame{width:100%;height:300px;border-radius:10px;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
.footer{padding:12px;text-align:center;color:var(--muted);font-size:13px}

/* login modal */
#loginModal{position:fixed;inset:0;display:grid;place-items:center;background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.75));z-index:60}
.loginCard{width:460px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 18px 60px rgba(0,0,0,0.75)}
.loginCard h3{margin:0 0 8px;color:var(--accent)}
.inputRow{margin-top:8px;display:flex;gap:8px;align-items:center}

/* small toast */
#toast{position:fixed;right:18px;bottom:18px;background:#012b23;border:1px solid rgba(0,230,134,0.08);padding:10px 14px;border-radius:10px;color:#dff;opacity:0;transform:translateY(8px);transition:all .25s}
.mark{background:rgba(255,215,0,0.14);padding:2px 6px;border-radius:4px;color:#fff}
.small{font-size:13px;color:var(--muted)}

</style>
</head>
<body>
<div id="loginModal" aria-modal="true">
  <div class="loginCard" role="dialog" aria-labelledby="loginTitle">
    <div style="display:flex;gap:12px;align-items:center">
      <div class="logoBox" aria-hidden="true" id="loginLogo">
        <!-- default svg -->
        <svg viewBox="0 0 64 64" width="46" height="46" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#00e486"/><stop offset="1" stop-color="#16c7ff"/></linearGradient></defs><path d="M32 6c9 6 18 6 18 6v16c0 14-9 21-18 24-9-3-18-10-18-24V12s9 0 18-6Z" stroke="url(#g1)" stroke-width="2.4" fill="rgba(0,255,150,0.04)"/></svg>
      </div>
      <div>
        <h3 id="loginTitle">SMART CRIME TRACKER ‚Äî PRESENTATION DEMO</h3>
        <div class="tiny">Demo credentials: <span class="mark">admin / Allah@1</span> ‚Ä¢ <span class="mark">user / 1234</span></div>
      </div>
    </div>

    <hr style="border:none;height:8px;background:linear-gradient(90deg,transparent,rgba(0,255,150,0.06),transparent);margin:12px 0 14px"/>

    <label class="tiny">User</label>
    <input id="Luser" type="text" placeholder="admin"/>
    <label class="tiny">Password</label>
    <input id="Lpass" type="password" placeholder="Allah@1"/>
    <div style="display:flex;gap:8px;margin-top:10px">
      <button class="btn" onclick="doLogin()">Enter</button>
      <button class="ghost" onclick="fillQuick()">Fill demo</button>
    </div>
    <p id="Lmsg" class="tiny" style="margin-top:10px;color:#ffb3b3"></p>
  </div>
</div>

<div class="container" id="app" aria-hidden="true">
  <div class="header">
    <div class="logoBox" id="logoBox"></div>
    <div class="title">
      <h1>SMART CRIME TRACKER</h1>
      <p class="small">Presentation ‚Ä¢ Demo UI ‚Äî No live telecom hooks</p>
    </div>
  </div>

  <div class="topbar">
    <nav class="nav" role="navigation">
      <button class="navbtn active" data-tab="dashboard" onclick="navTo(event)">Dashboard</button>
      <button class="navbtn" data-tab="search" onclick="navTo(event)">Number Search</button>
      <button class="navbtn" data-tab="cdr" onclick="navTo(event)">CDR</button>
      <button class="navbtn" data-tab="map" onclick="navTo(event)">Map</button>
      <button class="navbtn" data-tab="ai" onclick="navTo(event)">AI</button>
      <button class="navbtn" data-tab="fb" onclick="navTo(event)">Facebook</button>
      <button class="navbtn" data-tab="admin" onclick="navTo(event)">Admin</button>
    </nav>
    <div class="userInfo" id="userInfo">Not signed in</div>
  </div>

  <div class="layout">
    <main>
      <!-- dashboard -->
      <section id="tab-dashboard" class="panel">
        <div class="kpis">
          <div class="kpi"><div class="tiny">Active Cases</div><div class="num" id="kActive">0</div></div>
          <div class="kpi"><div class="tiny">High Risk</div><div class="num" id="kHigh">0</div></div>
          <div class="kpi"><div class="tiny">Alerts Today</div><div class="num" id="kAlerts">0</div></div>
        </div>

        <div class="grid2">
          <div class="panel">
            <h4 style="margin:0 0 8px;color:var(--accent)">Quick Actions</h4>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn" onclick="openTab('search')">üîé Number Search</button>
              <button class="btn" onclick="openTab('map')">üõ∞ Map</button>
              <button class="btn" onclick="openTab('cdr')">üìã Load CDR</button>
              <button class="btn" onclick="openTab('ai')">ü§ñ Run AI</button>
            </div>
          </div>

          <div class="panel">
            <h4 style="margin:0 0 8px;color:var(--accent)">Recent Alerts (Demo)</h4>
            <table><thead><tr><th>Time</th><th>Event</th><th>Risk</th></tr></thead>
              <tbody id="alertsTbl"><tr><td>09:12</td><td>Unusual port activity</td><td style="color:#ffd700">Medium</td></tr></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- number search -->
      <section id="tab-search" class="panel" style="display:none">
        <h4 style="color:var(--accent);margin-top:0">Number / SIM Search (Demo)</h4>
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:12px">
          <input id="searchNum" placeholder="e.g. +8801XXXXXXXXX" />
          <button class="btn" onclick="doNumberSearch()">Search</button>
          <button class="ghost" onclick="clearSearch()">Clear</button>
        </div>
        <div id="searchResult"></div>
        <div class="note">Demo-only: ‡¶™‡ßç‡¶∞‡¶ï‡ßÉ‡¶§ API-‡¶è ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶≤‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞-‡¶¨‡ßá‡¶á‡¶ú‡¶° ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡ßü‡¶æ ‡¶ì ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶Æ‡ßã‡¶¶‡¶® ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá‡•§</div>
      </section>

      <!-- CDR -->
      <section id="tab-cdr" class="panel" style="display:none">
        <h4 style="color:var(--accent);margin-top:0">Call Detail Records (Demo)</h4>
        <div style="display:flex;gap:8px;margin-bottom:8px">
          <button class="btn" onclick="loadCDR()">Load Sample CDR</button>
          <button class="ghost" onclick="exportCDR()">Export CSV</button>
        </div>
        <div style="overflow:auto">
          <table id="cdrTbl"><thead><tr><th>Time</th><th>Caller</th><th>Callee</th><th>Dur(s)</th><th>Cell</th></tr></thead><tbody></tbody></table>
        </div>
      </section>

      <!-- AI -->
      <section id="tab-ai" class="panel" style="display:none">
        <h4 style="color:var(--accent);margin-top:0">AI Analyzer (Demo)</h4>
        <p class="tiny">Paste event text ‚Äî demo highlights suspicious keywords and produces a risk score.</p>
        <textarea id="aiInput" placeholder="Example: cash drop at port, meet handler at gate 3" style="min-height:90px"></textarea>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" onclick="runAIDemo()">Analyze</button>
          <button class="ghost" onclick="clearAIDemo()">Clear</button>
        </div>
        <div id="aiOut" style="margin-top:12px"></div>
      </section>

      <!-- FB -->
      <section id="tab-fb" class="panel" style="display:none">
        <h4 style="color:var(--accent);margin-top:0">Facebook / Social (Demo)</h4>
        <div style="display:flex;gap:8px">
          <input id="fbUrl" placeholder="https://facebook.com/username"/>
          <button class="btn" onclick="fbAnalyze()">Analyze</button>
          <button class="ghost" onclick="fbClear()">Clear</button>
        </div>
        <div id="fbOut" style="margin-top:12px"></div>
      </section>
    </main>

    <aside>
      <div class="panel" style="margin-bottom:12px">
        <h4 style="margin:0 0 8px;color:var(--accent)">Map (Embed Demo)</h4>
        <div class="mapFrame">
          <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14604.69688454172!2d90.40744!3d23.7104!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1" style="width:100%;height:100%;border:0" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
      </div>

      <div class="panel" style="margin-bottom:12px">
        <h4 style="margin:0 0 8px;color:var(--accent)">Suspicious Handlers</h4>
        <table><thead><tr><th>Handler</th><th>Score</th></tr></thead><tbody id="handlerTbl"><tr><td>HND-0173****210</td><td>78</td></tr><tr><td>HND-0182****905</td><td>64</td></tr></tbody></table>
        <div style="margin-top:8px"><button class="btn" onclick="analyzeHandlers()">Re-analyze</button></div>
      </div>

      <div class="panel">
        <h4 style="margin:0 0 8px;color:var(--accent)">Admin Approval</h4>
        <table id="adminTbl"><thead><tr><th>Request</th><th>User</th><th>Status</th><th>Action</th></tr></thead>
          <tbody>
            <tr><td>CDR Access: 01700000000</td><td>ops_17</td><td id="req0">Pending</td><td><button class="ghost" onclick="approve(0)">Approve</button> <button class="ghost" onclick="reject(0)">Reject</button></td></tr>
            <tr><td>Geo Sweep: Tati Bazar</td><td>op_unit</td><td id="req1">Pending</td><td><button class="ghost" onclick="approve(1)">Approve</button> <button class="ghost" onclick="reject(1)">Reject</button></td></tr>
          </tbody></table>
      </div>

      <div class="panel" style="margin-top:12px">
        <h4 style="margin:0 0 8px;color:var(--accent)">Logo Manager (Local)</h4>
        <input id="logoFile" type="file" accept="image/*,image/svg+xml"/>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" id="saveLogoBtn">Save Logo</button>
          <button class="ghost" id="downloadLogoBtn">Download</button>
          <button class="ghost" id="resetLogoBtn">Reset</button>
        </div>
        <div id="logoPreview" style="margin-top:10px;min-height:56px;display:grid;place-items:center;background:rgba(255,255,255,0.02);border-radius:6px"></div>
        <div class="note">Logo saved in browser localStorage only. For site-wide persistence, upload to server.</div>
      </div>

    </aside>
  </div>

  <div class="footer">Presentation Demo ‚Ä¢ Use only with lawful authorization ‚Ä¢ ¬© Smart Crime Tracker</div>
</div>

<div id="toast"></div>

<script>
/* Helpers */
const $ = s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
const toast = t=>{ const e = $('#toast'); e.textContent = t; e.style.opacity=1; setTimeout(()=>e.style.opacity=0,2200); }

/* Login */
function doLogin(){
  const u = $('#Luser').value.trim(), p = $('#Lpass').value;
  if(!u||!p){ $('#Lmsg').textContent='Enter credentials'; return; }
  if((u==='admin' && p==='Allah@1') || (u==='user' && p==='1234')){
    $('#loginModal').style.display='none';
    $('#app').removeAttribute('aria-hidden');
    $('#userInfo').textContent = `Signed in: ${u}`;
    window.currentUser = u;
    toast('Logged in as '+u);
    bootstrap();
    loadSavedLogo();
  } else { $('#Lmsg').textContent='Invalid demo credentials'; }
}
function fillQuick(){ $('#Luser').value='admin'; $('#Lpass').value='Allah@1'; $('#Lmsg').textContent=''; }

/* Nav */
function navTo(e){ $$('.nav button').forEach(b=>b.classList.remove('active')); e.currentTarget.classList.add('active'); const tab = e.currentTarget.dataset.tab; $$('#app main section').forEach(s=>s.style.display='none'); const el = document.querySelector('#tab-'+tab); if(el) el.style.display='block'; }
function openTab(n){ const b = Array.from($$('.nav button')).find(x=>x.dataset.tab===n); if(b) b.click(); }

/* Bootstrap KPIs */
function bootstrap(){ animate('#kActive',12,30); animate('#kHigh',3,40); animate('#kAlerts',7,30); analyzeHandlers(); }
function animate(sel,target,ms){ let n=0; const el=$(sel); const iv=setInterval(()=>{ n++; el.textContent=n; if(n>=target) clearInterval(iv); }, ms); }

/* Number search (demo) */
function doNumberSearch(){
  const q = $('#searchNum').value.trim(); const out = $('#searchResult'); out.innerHTML='';
  if(!q){ out.textContent='Provide number'; return; }
  // MOCK logic ‚Äî do not call any real API
  let resp;
  if(q.includes('0170')||q.includes('0171')) resp = `<b>${q}</b> ‚Äî Owner: Unknown (Flagged) ‚Ä¢ LastSeen: Motijheel ‚Ä¢ <span style="color:#ffd700">Risk: High</span>`;
  else if(q.includes('018')) resp = `<b>${q}</b> ‚Äî Owner: Local Trader ‚Ä¢ Location: Bashundhara ‚Ä¢ <span style="color:#9fdad0">Risk: Low</span>`;
  else resp = `<b>${q}</b> ‚Äî No public records (demo)`;
  out.innerHTML = `<div style="padding:10px;background:rgba(0,0,0,0.12);border-radius:8px">${resp}</div>`;
  toast('Number search (demo) complete');
}
function clearSearch(){ $('#searchNum').value=''; $('#searchResult').innerHTML=''; }

/* CDR */
const SAMPLE = [
  {t:'2025-09-01 09:12', caller:'01700000001', callee:'01800000002', dur:120, cell:'Dhaka'},
  {t:'2025-09-01 11:05', caller:'01800000002', callee:'01700000003', dur:45, cell:'Chattogram'},
  {t:'2025-09-02 23:50', caller:'01700000001', callee:'01900000004', dur:12, cell:'Rangpur'},
  {t:'2025-09-03 10:10', caller:'01700000005', callee:'01700000001', dur:35, cell:'Sylhet'}
];
function loadCDR(){ renderCDR(SAMPLE); toast('Sample CDR loaded'); }
function renderCDR(rows){ const t=$('#cdrTbl tbody'); t.innerHTML=''; (rows||[]).forEach(r=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${r.t}</td><td>${r.caller}</td><td>${r.callee}</td><td>${r.dur}</td><td>${r.cell}</td>`; t.appendChild(tr); }); }
function exportCDR(){ const rows=SAMPLE; if(!rows.length){ toast('No CDR'); return;} const csv=['Time,Caller,Callee,Duration,Cell', ...rows.map(r=>`${r.t},${r.caller},${r.callee},${r.dur},${r.cell}`)].join('\n'); const b=new Blob([csv],{type:'text/csv'}); const a=document.createElement('a'); a.href=URL.createObjectURL(b); a.download='cdr_demo.csv'; a.click(); toast('CDR exported'); }

/* Handlers */
function analyzeHandlers(){ const tbl=$('#handlerTbl'); tbl.innerHTML=''; ['HND-0173****210','HND-0182****905','HND-0167****441'].forEach(n=>{ const sc=40+Math.floor(Math.random()*50); const tr=document.createElement('tr'); tr.innerHTML=`<td>${n}</td><td>${sc}</td>`; tbl.appendChild(tr); }); toast('Handlers analyzed (demo)'); }

/* AI demo */
const BAD = ['cash','drop','handler','gold','port','gate','transfer','hawala','parcel','meet','sell','buy'];
function runAIDemo(){ const txt=$('#aiInput').value.trim(); if(!txt){ toast('Write text to analyze'); return;} const tokens=txt.split(/\b/); const processed=tokens.map(t=> BAD.includes(t.toLowerCase())? `<mark style="background:rgba(255,215,0,0.22);padding:2px;border-radius:3px">${t}</mark>`:t).join(''); const score=Math.min(98, (txt.match(/\d+/g)||[]).join('').length + Math.min(70,Math.floor(txt.length/2))); $('#aiOut').innerHTML = `<div style="background:rgba(0,0,0,0.12);padding:12px;border-radius:8px"><b>Risk Score:</b> ${score}% &nbsp; <span style="color:${score>70?'#ff6b6b':'#ffd166'}">${score>70?'High':'Moderate'}</span><div style="margin-top:8px">${processed}</div></div>`; toast('AI demo complete'); }
function clearAIDemo(){ $('#aiInput').value=''; $('#aiOut').innerHTML=''; }

/* FB demo */
function fbAnalyze(){ const url=$('#fbUrl').value.trim(); if(!url){ toast('Paste public profile link'); return;} const name=(url.match(/facebook\.com\/([^\/?#]+)/i)||[])[1]||'unknown'; const s=40+Math.floor(Math.random()*60); $('#fbOut').innerHTML=`<div style="background:rgba(0,0,0,0.12);padding:10px;border-radius:8px"><b>${name}</b> ‚Äî Public signals score: <b>${s}%</b></div>`; toast('FB demo scored'); }
function fbClear(){ $('#fbUrl').value=''; $('#fbOut').innerHTML=''; }

/* Admin approve/reject */
function approve(i){ $('#req'+i).textContent='Approved'; toast('Approved (demo)'); }
function reject(i){ $('#req'+i).textContent='Rejected'; toast('Rejected (demo)'); }

/* Logo upload/save/download/reset (localStorage) */
const LOGO_KEY = 'sct_logo_v1';
function isAdmin(){ return window.currentUser === 'admin'; }
function loadSavedLogo(){
  const raw = localStorage.getItem(LOGO_KEY);
  const logoBox = $('#logoBox'), loginLogo = $('#loginLogo');
  const preview = $('#logoPreview');
  if(!logoBox) return;
  if(!raw){
    logoBox.innerHTML = loginLogo.innerHTML;
    if(preview) preview.innerHTML = '<div class="small" style="opacity:.8">Default</div>';
    return;
  }
  if(raw.startsWith('<svg') || raw.includes('<svg')){
    logoBox.innerHTML = raw;
    if(loginLogo) loginLogo.innerHTML = raw;
    if(preview) preview.innerHTML = raw;
  } else if(raw.startsWith('data:')){
    logoBox.innerHTML = `<img src="${raw}" style="max-width:100%;max-height:100%;border-radius:8px">`;
    if(loginLogo) loginLogo.innerHTML = `<img src="${raw}" style="max-width:100%;max-height:56px;border-radius:8px">`;
    if(preview) preview.innerHTML = `<img src="${raw}" style="max-width:100%;max-height:100%;border-radius:6px">`;
  } else {
    logoBox.innerHTML = raw;
    if(preview) preview.innerHTML = raw;
  }
}
const logoFileEl = $('#logoFile');
if(logoFileEl){
  logoFileEl.addEventListener('change', (ev)=>{
    const f = ev.target.files && ev.target.files[0];
    const preview = $('#logoPreview');
    if(!f || !preview) return;
    const reader = new FileReader();
    reader.onload = function(e){
      const result = e.target.result;
      if(f.type === 'image/svg+xml' || (typeof result === 'string' && result.trim().startsWith('<svg'))){
        preview.innerHTML = result; preview.dataset.pending = result; toast('SVG ready to save (click Save).');
      } else { preview.innerHTML = `<img src="${result}" style="max-width:100%;max-height:100%;border-radius:6px">`; preview.dataset.pending = result; toast('Image ready to save (click Save).'); }
    };
    if(f.type === 'image/svg+xml') reader.readAsText(f); else reader.readAsDataURL(f);
  });
}
$('#saveLogoBtn')?.addEventListener('click', ()=>{
  if(!isAdmin()){ toast('Only admin can save logo'); return; }
  const preview = $('#logoPreview'); if(!preview || !preview.dataset.pending){ toast('No uploaded logo to save'); return; }
  try{ localStorage.setItem(LOGO_KEY, preview.dataset.pending); loadSavedLogo(); delete preview.dataset.pending; if(logoFileEl) logoFileEl.value = ''; toast('Logo saved locally'); } catch(err){ console.error(err); toast('Save failed'); }
});
$('#downloadLogoBtn')?.addEventListener('click', ()=>{
  const raw = localStorage.getItem(LOGO_KEY); if(!raw){ toast('No saved logo'); return; }
  if(raw.startsWith('<svg') || raw.includes('<svg')){ const blob=new Blob([raw],{type:'image/svg+xml'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='sct-logo.svg'; a.click(); URL.revokeObjectURL(a.href); }
  else if(raw.startsWith('data:')){ fetch(raw).then(r=>r.blob()).then(blob=>{ const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='sct-logo.png'; a.click(); URL.revokeObjectURL(a.href); }); }
  toast('Download started');
});
$('#resetLogoBtn')?.addEventListener('click', ()=>{
  if(!isAdmin()){ toast('Only admin can reset'); return; }
  localStorage.removeItem(LOGO_KEY); loadSavedLogo(); toast('Reset done');
});

/* Misc */
document.addEventListener('keydown', e=>{ if(e.key==='Enter' && document.getElementById('loginModal') && document.getElementById('loginModal').style.display!=='none'){ doLogin(); }});
document.addEventListener('DOMContentLoaded', ()=>{ loadSavedLogo(); });

</script>
</body>
</html>
